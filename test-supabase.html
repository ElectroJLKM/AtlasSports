<!DOCTYPE html>
<html>
<head>
    <title>Test Supabase</title>
</head>
<body>
    <h1>Test Supabase</h1>
    <button onclick="test()">Test Conexión</button>
    <button onclick="getEvents()">Get Events</button>
    <div id="result"></div>

    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script>
        const SUPABASE_URL = "https://uqffsnrhasfqfcswkncf.supabase.co";
        const SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InVxZmZzbnJoYXNmcWZjc3drbmNmIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njk1NzgyMDcsImV4cCI6MjA4NTE1NDIwN30.qVcKz8PuuEOBsObidm7Phmx-pw8iitYkH3Hzyc_E9Ak";
        
        const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
        
        async function test() {
            const resultDiv = document.getElementById('result');
            resultDiv.innerHTML = "Probando conexión...";
            
            try {
                // Prueba 1: Verificar que supabase se cargó
                resultDiv.innerHTML += "<br>✅ Supabase cargado";
                
                // Prueba 2: Intentar consulta simple
                const { data, error } = await supabase.from('events').select('*').limit(1);
                
                if (error) {
                    resultDiv.innerHTML += `<br>❌ Error: ${error.message}`;
                    resultDiv.innerHTML += `<br>⚠️ Código: ${error.code}`;
                    resultDiv.innerHTML += `<br>⚠️ Detalles: ${JSON.stringify(error)}`;
                } else {
                    resultDiv.innerHTML += `<br>✅ Conexión OK. Datos: ${data.length} registros`;
                }
            } catch (err) {
                resultDiv.innerHTML += `<br>❌ Excepción: ${err.message}`;
            }
        }
        
        async function getEvents() {
            const resultDiv = document.getElementById('result');
            resultDiv.innerHTML = "Obteniendo eventos...";
            
            try {
                const { data, error } = await supabase
                    .from('events')
                    .select('*')
                    .order('start_date');
                
                if (error) {
                    resultDiv.innerHTML = `❌ ERROR: ${error.message}`;
                    console.error("Error completo:", error);
                } else {
                    resultDiv.innerHTML = `✅ ${data.length} eventos encontrados:`;
                    data.forEach(event => {
                        resultDiv.innerHTML += `<br>- ${event.id}: ${event.title} (${event.start_date} a ${event.end_date})`;
                    });
                }
            } catch (err) {
                resultDiv.innerHTML = `❌ EXCEPCIÓN: ${err.message}`;
            }
        }
    </script>
</body>
</html>
