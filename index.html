<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Atlas Sports - Comunidad de Duck Game</title>
  <link rel="stylesheet" href="css/main.css">
  <link rel="icon" href="assets/logo.png" type="image/png">
  
  <!-- Cargar Supabase desde CDN -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.39.0/dist/umd/supabase.min.js"></script>
  
  <style>
    /* Peque침os ajustes adicionales */
    .user-badge {
      display: flex;
      align-items: center;
      gap: 10px;
      background: rgba(255,255,255,0.1);
      padding: 8px 16px;
      border-radius: 20px;
      margin-right: 15px;
    }
  </style>
</head>
<body>
  <!-- Header/Navbar -->
  <header class="navbar">
    <div class="brand">
      <img src="assets/logo.png" class="logo" alt="Logo Atlas Sports">
      <a href="index.html" style="color: inherit; text-decoration: none;">
        <span>Atlas Sports</span>
      </a>
    </div>

    <nav class="menu">
      <a href="#inicio">Inicio</a>
      <a href="noticias.html">Noticias</a>
      <a href="ranked.html">Ranked</a>
      <a href="torneos.html">Torneos</a>
      <a href="comunidad.html">Comunidad</a>
    </nav>

    <div class="auth" id="authSection">
      <!-- Aqu칤 se cargar치 din치micamente login/register o perfil -->
      <a href="login.html" class="login-btn">Iniciar Sesi칩n</a>
      <a href="register.html" class="btn">Registrarse</a>
    </div>
  </header>

  <!-- Hero Section -->
  <main class="hero" id="inicio">
    <div class="hero-content">
      <div class="hero-text">
        <h1>Atlas Sports</h1>
        <p class="subtitle">
          Pilar de la comunidad de Duck Game. Lugar donde se re칰nen jugadores
          no solo para socializar sino tambi칠n para demostrar habilidad.
        </p>
        <div class="hero-buttons">
          <a href="https://discord.gg/7ueUkNj5wX" class="cta discord-btn" target="_blank" rel="noopener">
            <img src="assets/discord-icon.svg" alt="Discord" class="btn-icon" style="filter: brightness(0) invert(1);">
            칔nete a nuestro Discord
          </a>
          <a href="torneos.html" class="cta secondary-btn">
            Ver Torneos Activos
          </a>
        </div>
      </div>
      <div class="hero-image">
        <img src="assets/hero.png" alt="Comunidad Atlas Sports jugando Duck Game">
      </div>
    </div>
  </main>

  <!-- Secci칩n de caracter칤sticas -->
  <section class="features">
    <h2>쯈u칠 ofrecemos?</h2>
    <div class="features-grid">
      <div class="feature-card">
        <h3>游끥 Torneos Regulares</h3>
        <p>Competencias semanales y mensuales con premios para los mejores jugadores.</p>
      </div>
      <div class="feature-card">
        <h3>游늳 Sistema de Ranking</h3>
        <p>Sigue tu progreso y compite por subir en la tabla de l칤deres.</p>
      </div>
      <div class="feature-card">
        <h3>游논 Comunidad Activa</h3>
        <p>+300 jugadores en Discord compartiendo estrategias y organizando partidas.</p>
      </div>
    </div>
  </section>

  <!-- Footer -->
  <footer class="footer">
    <p>Atlas Sports 춸 2025 - Comunidad de Duck Game</p>
    <p>
      <a href="terminos.html">T칠rminos</a> |
      <a href="privacidad.html">Privacidad</a> |
      <a href="https://discord.gg/7ueUkNj5wX" target="_blank" rel="noopener">Contacto</a>
    </p>
  </footer>

  <!-- Script de autenticaci칩n -->
  <script>
    // CONFIGURACI칍N SEGURA PARA GITHUB PAGES
    const SUPABASE_URL = "https://uqffsnrhasfqfcswkncf.supabase.co";
    const SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InVxZmZzbnJoYXNmcWZjc3drbmNmIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njk1NzgyMDcsImV4cCI6MjA4NTE1NDIwN30.qVcKz8PuuEOBsObidm7Phmx-pw8iitYkH3Hzyc_E9Ak";
    
    const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
    
    // Verificar si el usuario est치 logueado
    async function checkAuth() {
      try {
        const { data: { session } } = await supabase.auth.getSession();
        return session;
      } catch (error) {
        console.error("Error checking auth:", error);
        return null;
      }
    }
    
    // Obtener perfil del usuario actual
    async function getCurrentUserProfile(userId) {
      try {
        const { data: profile, error } = await supabase
          .from('profiles')
          .select('username')
          .eq('id', userId)
          .single();
        
        if (error) throw error;
        return profile;
      } catch (error) {
        console.error("Error obteniendo perfil:", error);
        return null;
      }
    }
    
    // Actualizar la UI seg칰n el estado de autenticaci칩n
    async function updateAuthUI() {
      const authSection = document.getElementById('authSection');
      if (!authSection) return;
      
      const session = await checkAuth();
      
      if (session && session.user) {
        // Obtener username del perfil
        const profile = await getCurrentUserProfile(session.user.id);
        const userName = profile?.username || session.user.user_metadata?.username || session.user.email.split('@')[0];
        
        authSection.innerHTML = `
          <div class="user-badge">
            <a href="profile.html?u=${userName}" style="color: inherit; text-decoration: none; display: flex; align-items: center; gap: 5px;">
              <span>${userName}</span>
            </a>
          </div>
          <button onclick="logout()" class="btn">Cerrar Sesi칩n</button>
        `;
      } else {
        // Usuario NO logueado
        authSection.innerHTML = `
          <a href="login.html" class="login-btn">Iniciar Sesi칩n</a>
          <a href="register.html" class="btn">Registrarse</a>
        `;
      }
    }
    
    // Funci칩n para cerrar sesi칩n
    async function logout() {
      try {
        await supabase.auth.signOut();
        window.location.href = "index.html";
      } catch (error) {
        console.error("Error logging out:", error);
      }
    }
    
    // Inicializar cuando cargue la p치gina
    document.addEventListener('DOMContentLoaded', updateAuthUI);
  </script>
</body>
</html>
